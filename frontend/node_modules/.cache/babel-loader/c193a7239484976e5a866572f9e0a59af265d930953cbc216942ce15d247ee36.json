{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst d3_selection_1 = require(\"d3-selection\");\nconst d3_color_1 = require(\"d3-color\");\nconst utils_1 = __importDefault(require(\"../utils\"));\nconst evaluate_1 = __importDefault(require(\"../evaluate\"));\nfunction scatter(chart) {\n  const xScale = chart.meta.xScale;\n  const yScale = chart.meta.yScale;\n  function scatter(selection) {\n    selection.each(function (d) {\n      let i, j;\n      const index = d.index;\n      const color = utils_1.default.color(d, index);\n      const evaluatedData = (0, evaluate_1.default)(chart, d);\n      // scatter doesn't need groups, therefore each group is\n      // flattened into a single array\n      const joined = [];\n      for (i = 0; i < evaluatedData.length; i += 1) {\n        for (j = 0; j < evaluatedData[i].length; j += 1) {\n          joined.push(evaluatedData[i][j]);\n        }\n      }\n      const innerSelection = (0, d3_selection_1.select)(this).selectAll(':scope > circle').data(joined);\n      const cls = `scatter scatter-${index}`;\n      const innerSelectionEnter = innerSelection.enter().append('circle').attr('class', cls);\n      const selection = innerSelection.merge(innerSelectionEnter).attr('fill', (0, d3_color_1.hsl)(color.toString()).brighter(1.5).hex()).attr('stroke', color).attr('opacity', 0.7).attr('r', 1).attr('cx', function (d) {\n        return xScale(d[0]);\n      }).attr('cy', function (d) {\n        return yScale(d[1]);\n      });\n      if (d.attr) {\n        for (const k in d.attr) {\n          // If the attribute to modify is class then append the default class\n          // or otherwise the d3 selection won't work.\n          let val = d.attr[k];\n          if (k === 'class') {\n            val = `${cls} ${d.attr[k]}`;\n          }\n          selection.attr(k, val);\n        }\n      }\n      innerSelection.exit().remove();\n    });\n  }\n  return scatter;\n}\nexports.default = scatter;","map":{"version":3,"names":["d3_selection_1","require","d3_color_1","utils_1","__importDefault","evaluate_1","scatter","chart","xScale","meta","yScale","selection","each","d","i","j","index","color","default","evaluatedData","joined","length","push","innerSelection","select","selectAll","data","cls","innerSelectionEnter","enter","append","attr","merge","hsl","toString","brighter","hex","k","val","exit","remove","exports"],"sources":["../../src/graph-types/scatter.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}