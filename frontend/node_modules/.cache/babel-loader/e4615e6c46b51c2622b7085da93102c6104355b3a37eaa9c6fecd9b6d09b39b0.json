{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst d3_shape_1 = require(\"d3-shape\");\nconst d3_selection_1 = require(\"d3-selection\");\nfunction annotations(options) {\n  const xScale = options.owner.meta.xScale;\n  const yScale = options.owner.meta.yScale;\n  const line = (0, d3_shape_1.line)().x(function (d) {\n    return d[0];\n  }).y(function (d) {\n    return d[1];\n  });\n  return function (parentSelection) {\n    parentSelection.each(function () {\n      // join\n      const current = (0, d3_selection_1.select)(this);\n      const selection = current.selectAll('g.annotations').data(function (d) {\n        return d.annotations || [];\n      });\n      // enter\n      const enter = selection.enter().append('g').attr('class', 'annotations');\n      // enter + update\n      // - path\n      const yRange = yScale.range();\n      const xRange = xScale.range();\n      // prettier-ignore\n      const path = selection.merge(enter).selectAll('path').data(function (d) {\n        if ('x' in d) {\n          return [[[0, yRange[0]], [0, yRange[1]]]];\n        } else {\n          return [[[xRange[0], 0], [xRange[1], 0]]];\n        }\n      });\n      path.enter().append('path').attr('stroke', '#eee').attr('d', line);\n      path.exit().remove();\n      // enter + update\n      // - text\n      const text = selection.merge(enter).selectAll('text').data(function (d) {\n        return [{\n          text: d.text || '',\n          hasX: 'x' in d\n        }];\n      });\n      text.enter().append('text').attr('y', function (d) {\n        return d.hasX ? 3 : 0;\n      }).attr('x', function (d) {\n        return d.hasX ? 0 : 3;\n      }).attr('dy', function (d) {\n        return d.hasX ? 5 : -5;\n      }).attr('text-anchor', function (d) {\n        return d.hasX ? 'end' : '';\n      }).attr('transform', function (d) {\n        return d.hasX ? 'rotate(-90)' : '';\n      }).text(function (d) {\n        return d.text;\n      });\n      text.exit().remove();\n      // enter + update\n      // move group\n      selection.merge(enter).attr('transform', function (d) {\n        if ('x' in d) {\n          return 'translate(' + xScale(d.x) + ', 0)';\n        } else {\n          return 'translate(0, ' + yScale(d.y) + ')';\n        }\n      });\n      // exit\n      selection.exit().remove();\n    });\n  };\n}\nexports.default = annotations;","map":{"version":3,"names":["d3_shape_1","require","d3_selection_1","annotations","options","xScale","owner","meta","yScale","line","x","d","y","parentSelection","each","current","select","selection","selectAll","data","enter","append","attr","yRange","range","xRange","path","merge","exit","remove","text","hasX","exports","default"],"sources":["../../src/helpers/annotations.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}