{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst globals_1 = __importDefault(require(\"./globals\"));\nconst samplers_1 = require(\"./samplers\");\nconst evalTypeFn = {\n  interval: samplers_1.interval,\n  builtIn: samplers_1.builtIn\n};\n/**\n * Computes the endpoints x_lo, x_hi of the range\n * from which the sampler will take samples\n *\n * @param {Object} scale\n * @param {Object} d An item from `data`\n * @returns {Array}\n */\nfunction computeEndpoints(scale, d) {\n  const range = d.range || [-Infinity, Infinity];\n  const start = Math.max(scale.domain()[0], range[0]);\n  const end = Math.min(scale.domain()[1], range[1]);\n  return [start, end];\n}\n/**\n * Decides which sampler function to call based on the options\n * of `data`\n *\n * @param {Object} chart Chart instance which is orchestrating this sampling operation\n * @param {Object} d a.k.a a single item from `data`\n * @returns [number, number]\n */\nfunction evaluate(chart, d) {\n  const range = computeEndpoints(chart.meta.xScale, d);\n  const evalFn = evalTypeFn[d.sampler];\n  const nSamples = d.nSamples || Math.min(globals_1.default.MAX_ITERATIONS, globals_1.default.DEFAULT_ITERATIONS || chart.meta.width * 2);\n  const data = evalFn(chart, d, range, nSamples);\n  // NOTE: it's impossible to listen for the first eval event\n  // as the event is already fired when a listener is attached\n  chart.emit('eval', data, d.index, d.isHelper);\n  return data;\n}\nexports.default = evaluate;","map":{"version":3,"names":["globals_1","__importDefault","require","samplers_1","evalTypeFn","interval","builtIn","computeEndpoints","scale","d","range","Infinity","start","Math","max","domain","end","min","evaluate","chart","meta","xScale","evalFn","sampler","nSamples","default","MAX_ITERATIONS","DEFAULT_ITERATIONS","width","data","emit","index","isHelper","exports"],"sources":["../src/evaluate.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;AAAA,MAAAA,SAAA,GAAAC,eAAA,CAAAC,OAAA;AACA,MAAAC,UAAA,GAAAD,OAAA;AAKA,MAAME,UAAU,GAAG;EACjBC,QAAQ,EAARF,UAAA,CAAAE,QAAQ;EACRC,OAAO,EAAPH,UAAA,CAAAG;CACD;AAED;;;;;;;;AAQA,SAASC,gBAAgBA,CAACC,KAAU,EAAEC,CAAM;EAC1C,MAAMC,KAAK,GAAGD,CAAC,CAACC,KAAK,IAAI,CAAC,CAACC,QAAQ,EAAEA,QAAQ,CAAC;EAC9C,MAAMC,KAAK,GAAGC,IAAI,CAACC,GAAG,CAACN,KAAK,CAACO,MAAM,EAAE,CAAC,CAAC,CAAC,EAAEL,KAAK,CAAC,CAAC,CAAC,CAAC;EACnD,MAAMM,GAAG,GAAGH,IAAI,CAACI,GAAG,CAACT,KAAK,CAACO,MAAM,EAAE,CAAC,CAAC,CAAC,EAAEL,KAAK,CAAC,CAAC,CAAC,CAAC;EACjD,OAAO,CAACE,KAAK,EAAEI,GAAG,CAAC;AACrB;AAEA;;;;;;;;AAQA,SAASE,QAAQA,CAACC,KAAY,EAAEV,CAAoB;EAClD,MAAMC,KAAK,GAAGH,gBAAgB,CAACY,KAAK,CAACC,IAAI,CAACC,MAAM,EAAEZ,CAAC,CAAC;EACpD,MAAMa,MAAM,GAAGlB,UAAU,CAACK,CAAC,CAACc,OAAO,CAAC;EACpC,MAAMC,QAAQ,GAAGf,CAAC,CAACe,QAAQ,IAAIX,IAAI,CAACI,GAAG,CAACjB,SAAA,CAAAyB,OAAO,CAACC,cAAc,EAAE1B,SAAA,CAAAyB,OAAO,CAACE,kBAAkB,IAAIR,KAAK,CAACC,IAAI,CAACQ,KAAK,GAAG,CAAC,CAAC;EAEnH,MAAMC,IAAI,GAAGP,MAAM,CAACH,KAAK,EAAEV,CAAC,EAAEC,KAAK,EAAEc,QAAQ,CAAC;EAC9C;EACA;EACAL,KAAK,CAACW,IAAI,CAAC,MAAM,EAAED,IAAI,EAAEpB,CAAC,CAACsB,KAAK,EAAEtB,CAAC,CAACuB,QAAQ,CAAC;EAC7C,OAAOH,IAAI;AACb;AAEAI,OAAA,CAAAR,OAAA,GAAeP,QAAQ"},"metadata":{},"sourceType":"script","externalDependencies":[]}